{"version":3,"sources":["../../src/series_overrides_ctrl.js"],"names":["define","angular","jquery","_","module","controller","$scope","$element","popoverSrv","overrideMenu","currentOverrides","override","addOverrideOption","name","propertyName","values","option","text","index","length","submenu","map","value","String","push","setOverride","item","subItem","openColorSelector","ctrl","addSeriesOverride","alias","lines","updateCurrentOverrides","render","colorSelected","color","show","element","find","position","openOn","template","model","autoClose","onClose","removeOverride","refresh","getSeriesNames","seriesList","series","each","isUndefined"],"mappings":"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","file":"series_overrides_ctrl.js","sourcesContent":["define([\n  'angular',\n  'jquery',\n  'lodash',\n], function(angular, jquery, _) {\n  'use strict';\n\n  var module = angular.module('grafana.controllers');\n\n  module.controller('SeriesOverridesCtrl', function($scope, $element, popoverSrv) {\n    $scope.overrideMenu = [];\n    $scope.currentOverrides = [];\n    $scope.override = $scope.override || {};\n\n    $scope.addOverrideOption = function(name, propertyName, values) {\n      var option = {};\n      option.text = name;\n      option.propertyName = propertyName;\n      option.index = $scope.overrideMenu.length;\n      option.values = values;\n\n      option.submenu = _.map(values, function(value) {\n        return { text: String(value), value: value };\n      });\n\n      $scope.overrideMenu.push(option);\n    };\n\n    $scope.setOverride = function(item, subItem) {\n      // handle color overrides\n      if (item.propertyName === 'color') {\n        $scope.openColorSelector();\n        return;\n      }\n\n      $scope.override[item.propertyName] = subItem.value;\n\n      // automatically disable lines for this series and the fill bellow to series\n      // can be removed by the user if they still want lines\n      if (item.propertyName === 'fillBelowTo') {\n        $scope.override['lines'] = false;\n        $scope.ctrl.addSeriesOverride({alias: subItem.value, lines: false });\n      }\n\n      $scope.updateCurrentOverrides();\n      $scope.ctrl.render();\n    };\n\n    $scope.colorSelected = function(color) {\n      $scope.override['color'] = color;\n      $scope.updateCurrentOverrides();\n      $scope.ctrl.render();\n    };\n\n    $scope.openColorSelector = function() {\n      popoverSrv.show({\n        element: $element.find(\".dropdown\")[0],\n        position: 'top center',\n        openOn: 'click',\n        template: '<gf-color-picker></gf-color-picker>',\n        model: {\n          autoClose: true,\n          colorSelected: $scope.colorSelected,\n        },\n        onClose: function() {\n          $scope.ctrl.render();\n        }\n      });\n    };\n\n    $scope.removeOverride = function(option) {\n      delete $scope.override[option.propertyName];\n      $scope.updateCurrentOverrides();\n      $scope.ctrl.refresh();\n    };\n\n    $scope.getSeriesNames = function() {\n      return _.map($scope.ctrl.seriesList, function(series) {\n        return series.alias;\n      });\n    };\n\n    $scope.updateCurrentOverrides = function() {\n      $scope.currentOverrides = [];\n      _.each($scope.overrideMenu, function(option) {\n        var value = $scope.override[option.propertyName];\n        if (_.isUndefined(value)) { return; }\n        $scope.currentOverrides.push({\n          name: option.text,\n          propertyName: option.propertyName,\n          value: String(value)\n        });\n      });\n    };\n\n    $scope.addOverrideOption('Bars', 'bars', [true, false]);\n    $scope.addOverrideOption('Lines', 'lines', [true, false]);\n    $scope.addOverrideOption('Line fill', 'fill', [0,1,2,3,4,5,6,7,8,9,10]);\n    $scope.addOverrideOption('Line width', 'linewidth', [0,1,2,3,4,5,6,7,8,9,10]);\n    $scope.addOverrideOption('Null point mode', 'nullPointMode', ['connected', 'null', 'null as zero']);\n    $scope.addOverrideOption('Fill below to', 'fillBelowTo', $scope.getSeriesNames());\n    $scope.addOverrideOption('Staircase line', 'steppedLine', [true, false]);\n    $scope.addOverrideOption('Dashes', 'dashes', [true, false]);\n    $scope.addOverrideOption('Dash Length', 'dashLength', [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]);\n    $scope.addOverrideOption('Dash Space', 'spaceLength', [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]);\n    $scope.addOverrideOption('Points', 'points', [true, false]);\n    $scope.addOverrideOption('Points Radius', 'pointradius', [1,2,3,4,5]);\n    $scope.addOverrideOption('Stack', 'stack', [true, false, 'A', 'B', 'C', 'D']);\n    $scope.addOverrideOption('Color', 'color', ['change']);\n    $scope.addOverrideOption('Y-axis', 'yaxis', [1, 2]);\n    $scope.addOverrideOption('Z-index', 'zindex', [-3,-2,-1,0,1,2,3]);\n    $scope.addOverrideOption('Transform', 'transform', ['negative-Y']);\n    $scope.addOverrideOption('Legend', 'legend', [true, false]);\n    $scope.updateCurrentOverrides();\n  });\n});\n"]}